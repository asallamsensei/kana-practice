<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Repaso de Kanji - Asallam Sensei</title>
<style>
    body {
        background: #fffaf3;
        font-family: Arial;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding-top: 40px;
    }

    h1 {
        margin-bottom: 10px;
    }

    #kanji {
        font-size: 120px;
        margin: 40px 0;
        font-weight: bold;
    }

    button {
        padding: 12px 20px;
        margin: 5px;
        font-size: 18px;
        border-radius: 10px;
        border: none;
        background: #d97706;
        color: white;
        cursor: pointer;
    }

    button:hover {
        background: #b45309;
    }

    #opciones {
        font-size: 24px;
        margin-top: 20px;
        text-align: left;
        line-height: 1.6;
    }

    #respuestaUsuario {
        margin-top: 15px;
        font-size: 22px;
        padding: 8px 12px;
        border-radius: 8px;
        border: 2px solid #aaa;
        text-align: center;
        width: 80px;
    }

    .correcto {
        color: #28a745;
        font-weight: bold;
    }

    .incorrecto {
        color: #d93025;
        font-weight: bold;
    }

    #resultado {
        margin-top: 15px;
        font-size: 24px;
    }

    #estadisticas {
        margin-top: 20px;
        font-size: 22px;
    }
</style>
</head>
<body>

<h1>Repaso de Kanji — Asallam Sensei</h1>

<div id="kanji">日</div>

<div id="opciones"></div>

<button onclick="mostrarRespuesta()">Mostrar respuesta</button>

<input id="respuestaUsuario"
       type="text"
       placeholder="a / b / c"
       maxlength="1"
       onkeydown="manejarEnter(event)">

<div id="resultado"></div>

<div id="estadisticas">
    Aciertos: <span id="aciertos">0</span> —
    Errores: <span id="errores">0</span>
</div>

<script>
let lista = [];
let actual = 0;
let aciertos = 0;
let errores = 0;
let correcta = "";
let significadoCorrecto = "";
let yaValidado = false;

// Cargar kanji desde JSON
fetch("data/kanji_1.json")
    .then(res => res.json())
    .then(data => {
        lista = data;
        siguiente();
    });

function siguiente() {
    if (lista.length < 3) return;

    actual = Math.floor(Math.random() * lista.length);
    const correcto = lista[actual];
    significadoCorrecto = correcto.significado;
    
    // generar opciones
    let opciones = [correcto.significado];
    while (opciones.length < 3) {
        const r = lista[Math.floor(Math.random() * lista.length)].significado;
        if (!opciones.includes(r)) opciones.push(r);
    }

    // mezclar
    opciones.sort(() => Math.random() - 0.5);

    const letras = ["a", "b", "c"];
    correcta = letras[opciones.indexOf(correcto.significado)];

    // mostrar
    document.getElementById("kanji").innerText = correcto.kanji;
    document.getElementById("opciones").innerHTML =
        `a) ${opciones[0]}<br>
         b) ${opciones[1]}<br>
         c) ${opciones[2]}`;

    document.getElementById("resultado").innerText = "";
    document.getElementById("respuestaUsuario").value = "";
    document.getElementById("respuestaUsuario").focus();

    yaValidado = false;
}

function verificar() {
    const r = document.getElementById("respuestaUsuario").value.toLowerCase().trim();
    const res = document.getElementById("resultado");

    if (r === correcta) {
        res.innerText = "Correcto ✔";
        res.className = "correcto";
        aciertos++;
        document.getElementById("aciertos").innerText = aciertos;
    } else {
        res.innerText = `Incorrecto ✘ (era ${correcta})`;
        res.className = "incorrecto";
        errores++;
        document.getElementById("errores").innerText = errores;
    }

    yaValidado = true;
}

function mostrarRespuesta() {
    const res = document.getElementById("resultado");
    res.innerText = `Significado: ${significadoCorrecto}`;
    res.className = "";
}

function manejarEnter(event) {
    if (event.key !== "Enter") return;

    if (!yaValidado) {
        verificar();
    } else {
        siguiente();
    }
}
</script>

</body>
</html>




